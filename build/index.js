$(document).ready(function(){var t={},n=$("#menu"),a=$("#content"),e=($("#loading"),$("#notfound")),i=null,o=!0,l="page",u=null,c={},r=function(t){return t.toString().toLowerCase().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-").replace(/^-+/,"").replace(/-+$/,"")},s=function(){return window.location.hash?window.location.hash.replace(/#/,""):null};$(window).on("hashchange",function(){f()});var d=function(){t.github&&n.append('<a id="github" href="'+t.github+'" class="menu-item button button-clear"><i class="fa fa-github fa-2x"></i></a>'),t.twitter&&n.append('<a id="twitter" href="'+t.twitter+'" class="menu-item button button-clear"><i class="fa fa-twitter fa-2x"></i></a>'),n.append('<button id="hamburger" class="button button-clear"><i class="fa fa-bars fa-2x"></i></button>')},f=function(){var n=s()||i;if(c[n]){var a=$('.page[id="'+n+'"]');$(".page").hide(),a.length>0?a.show():e.show()}else $.each(t.pages,function(t,a){a.slug==n&&h(a,function(t){c[n]=!0,f()})})},g=function(t,n){$.ajax({url:"./_data/templates/"+t+".hbs",error:function(t){n(t)},success:function(t){n(null,Handlebars.compile(t))}})},p=function(n,e,i){if(e.draft)return i();var u=jsyaml.loadFront(n),c=marked(u.__content),s=e.title||u.title,d=r(s||"untitled"),f=u;f.title=s,f.slug=d,f.firstPage=o,f.item=e,f.content=c,f.global=t;var p=e.layout||f.layout||l;if(p)g(p,function(t,n){var e=n(f),o=$("<div>").attr("id",d).addClass("page").html(e);o.css("display","none"),a.append(o),i(null)});else{var h=$("<div>").attr("id",d).addClass("page").html(c);h.css("display","none"),a.append(h),i(null)}},h=function(t,n){$("#loading").show(),$.ajax({url:"./_data/pages/"+t.page+".md",error:function(t){n(t),$("#loading").hide()},success:function(a){p(a,t,function(t){n(t),$("#loading").hide()})}})},b=function(t,a){var e=t.title,l=r(e||"untitled");t.slug=l,o&&(u=l,i=l,o=!1),n.append("<a class='menu-item button button-clear' href='#"+l+"'>"+t.title+"</a> "),a()},m=function(){t.pages=t.pages||[],async.eachSeries(t.pages,function(t,n){b(t,n)},function(t){t?console.log(t.statusText):($("#loading").hide(),d(),f())})},w=function(n,a){if(!n)return a("Error");$("#loading").show(),t=n;var e=t.title||"No title";t.description||"";$("#title").html(e),$("#title").click(function(t){window.location.href="./#"+u}),$("title").html(e),m()};$.getJSON("./_data/index.json",function(t){w(t,function(t){t&&alert("cannot load data")})})});